<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Orario Scolastico</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: var(--bg);
      color: var(--text);
      --bg: #ffffff;
      --text: #000000;
      --accent: #007bff;
    }
    body.dark {
      --bg: #121212;
      --text: #f0f0f0;
    }
    h1 { font-size: 1.5em; }
    .card {
      border: 1px solid var(--accent);
      border-radius: 10px;
      padding: 15px;
      margin: 10px 0;
    }
    select, button {
      margin-top: 10px;
      padding: 5px;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <h1>Orario Scolastico</h1>
  <div id="status"></div>
  <div id="materie"></div>
  <div id="storico"></div>

  <label for="giorno">Visualizza orario:</label>
  <select id="giorno">
    <option value="oggi">Oggi</option>
    <option value="Luned√¨">Luned√¨</option>
    <option value="Marted√¨">Marted√¨</option>
    <option value="Mercoled√¨">Mercoled√¨</option>
    <option value="Gioved√¨">Gioved√¨</option>
    <option value="Venerd√¨">Venerd√¨</option>
    <option value="Sabato">Sabato</option>
  </select>

  <br>
  <button onclick="toggleDarkMode()">Dark Mode</button>
  <button onclick="cambiaTema()">Cambia Colore Tema</button>

  <script>
    const orario = {
      "Luned√¨": [
        { start: "08:05", end: "09:05", materia: "S.T.A. INF" },
        { start: "09:05", end: "10:05", materia: "RELIGIONE" },
        { start: "10:05", end: "11:05", materia: "INGLESE" },
        { start: "11:05", end: "12:05", materia: "CHIMICA" },
        { start: "12:05", end: "13:05", materia: "FISICA" },
      ],
      "Marted√¨": [
        { start: "08:05", end: "09:05", materia: "S.T.A. INF" },
        { start: "09:05", end: "10:05", materia: "STORIA" },
        { start: "10:05", end: "11:05", materia: "CHIMICA" },
        { start: "11:05", end: "12:05", materia: "LAB. TTRG" },
        { start: "12:05", end: "13:05", materia: "MATEMATICA" },
        { start: "13:05", end: "14:05", materia: "INGLESE" },
      ],
      "Mercoled√¨": [
        { start: "08:05", end: "09:05", materia: "GRAMMATICA" },
        { start: "09:05", end: "10:05", materia: "MATEMATICA" },
        { start: "10:05", end: "11:05", materia: "MATEMATICA" },
        { start: "11:05", end: "12:05", materia: "SC. MOT. SPORT" },
        { start: "12:05", end: "13:05", materia: "SC. MOT. SPORT" },
      ],
      "Gioved√¨": [
        { start: "08:05", end: "09:05", materia: "DIRITTO - EC." },
        { start: "09:05", end: "10:05", materia: "LAB. FISICA" },
        { start: "10:05", end: "11:05", materia: "BIOLOGIA" },
        { start: "11:05", end: "12:05", materia: "T.T.R.G." },
        { start: "12:05", end: "13:05", materia: "ANTOLOGIA" },
        { start: "13:05", end: "14:05", materia: "ANTOLOGIA" },
      ],
      "Venerd√¨": [
        { start: "08:05", end: "09:05", materia: "GRAMMATICA" },
        { start: "09:05", end: "10:05", materia: "LAB. CHIMICA" },
        { start: "10:05", end: "11:05", materia: "FISICA" },
        { start: "11:05", end: "12:05", materia: "BIOLOGIA" },
        { start: "12:05", end: "13:05", materia: "MATEMATICA" },
      ],
      "Sabato": [
        { start: "08:05", end: "09:05", materia: "T.T.R.G." },
        { start: "09:05", end: "10:05", materia: "S.T.A. INF" },
        { start: "10:05", end: "11:05", materia: "INGLESE" },
        { start: "11:05", end: "12:05", materia: "DIRITTO - EC." },
        { start: "12:05", end: "13:05", materia: "STORIA" },
      ]
    };

    const festivi = []; // qui in futuro puoi aggiungere ["2025-12-25", "2025-01-01", ...]

    function aggiorna() {
      const oggi = new Date();
      const giornoSettimana = oggi.toLocaleDateString("it-IT", { weekday: "long" });
      const giorno = giornoSettimana.charAt(0).toUpperCase() + giornoSettimana.slice(1);
      const dataISO = oggi.toISOString().split("T")[0];

      const selezione = document.getElementById("giorno").value;
      const giornoDaMostrare = selezione === "oggi" ? giorno : selezione;

      const materieOggi = orario[giornoDaMostrare] || [];

      const statusDiv = document.getElementById("status");
      const materieDiv = document.getElementById("materie");
      const storicoDiv = document.getElementById("storico");

      statusDiv.innerHTML = "";
      materieDiv.innerHTML = "";
      storicoDiv.innerHTML = "";

      if (giornoDaMostrare === "Domenica" || festivi.includes(dataISO)) {
        statusDiv.innerHTML = "<p><b>SpongeBob oggi non lavora üßΩ</b></p>";
        return;
      }

      if (materieOggi.length === 0) {
        statusDiv.innerHTML = "<p>Nessuna lezione</p>";
        return;
      }

      const ora = oggi.getHours();
      const minuti = oggi.getMinutes();
      const adesso = `${String(ora).padStart(2, "0")}:${String(minuti).padStart(2, "0")}`;

      let prossima = null;
      let corrente = null;

      for (let m of materieOggi) {
        if (adesso >= m.start && adesso < m.end) {
          corrente = m;
        } else if (adesso < m.start && !prossima) {
          prossima = m;
        }
      }

      if (selezione === "oggi") {
        if (corrente) {
          const end = new Date();
          const [eh, em] = corrente.end.split(":");
          end.setHours(eh, em, 0);
          const diff = Math.max(0, Math.floor((end - oggi) / 60000));
          statusDiv.innerHTML = `<p>Ora: <b>${corrente.materia}</b> (finisce alle ${corrente.end}, manca ${diff} min)</p>`;
        } else if (prossima) {
          statusDiv.innerHTML = `<p>Prossima: <b>${prossima.materia}</b> (${prossima.start})</p>`;
        } else {
          statusDiv.innerHTML = "<p>Lezioni finite per oggi ‚úÖ</p>";
        }
      } else {
        statusDiv.innerHTML = `<p>Orario di <b>${giornoDaMostrare}</b>:</p>`;
      }

      materieOggi.forEach(m => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerText = `${m.start} - ${m.end}: ${m.materia}`;
        materieDiv.appendChild(card);
      });

      if (selezione === "oggi") {
        storicoDiv.innerHTML = `<p><b>Oggi hai fatto:</b> ${materieOggi.map(m => m.materia).join(", ")}</p>`;
      }
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark");
    }

    function cambiaTema() {
      const colori = ["#007bff", "#28a745", "#dc3545", "#ff9800", "#9c27b0"];
      const nuovo = colori[Math.floor(Math.random() * colori.length)];
      document.body.style.setProperty("--accent", nuovo);
    }

    setInterval(aggiorna, 60000);
    aggiorna();
    document.getElementById("giorno").addEventListener("change", aggiorna);
  </script>
</body>
</html>
